!スキンメッシュ レンダラ / Skinned Mesh Renderer

$$Skinned Mesh Renderer$$ (スキンメッシュ レンダラ)はメッシュがスキニングされている場合、インポート時に自動追加されます。

Attach:Inspector-SkinnedMeshRenderer.png\\
Skinned Mesh Rendererを用いてレンダリングされたアニメキャラクター


!! プロパティ

||PROPS
||``Cast Shadows`` (Pro only) ||オンにした場合、メッシュは影を生成するライトが照らしてたときに影を生成します。||
||``Receive Shadows`` (Pro only) ||オンにした場合、メッシュに対して投影された影を描画します。||
||``Materials`` ||モデルでレンダリングする$$Materials$$の一覧。||
||``Quality`` ||すべての頂点に影響を与えるボーンの最大数。||
||``Update When Offscreen`` ||オンにした場合、メッシュは画面の外のとき更新される。オフにした場合、アニメーションの更新が無効になります。||
||``Bounds`` ||このBounds（境界）はSkinned Meshを画面外に出たかどうかを判断するために用います。境界線となる箱もSceneViewに表示されます。境界は、インポート時にモデルに含まれるメッシュとアニメーションに基づいて事前計算されます。||
||``Mesh`` ||レンダラーによって使用されるメッシュ。||

!! 詳細

Skinned Meshは、キャラクターのレンダリングに使用されます。キャラクターはボーンを使用してアニメーション化しており、すべてのボーンは、メッシュの一部に影響を与えます。複数のボーンが同じひとつの頂点に影響を与えることができ、影響の大きさはと重み付けされています。Unityでボーンキャラクターを使用する主なメリットは、ボーンが物理挙動の影響を有効化することができ、キャラクターをRagdollにすることができます。スクリプトの中でボーンを有効/無効にすることができるので、爆発にあたったキャラクターを瞬時にRagdollにすることが出来ます。

Attach:RagdollRobot.png\\
Ragdollとして有効にしたSkinned mesh

!!! 品質

Unityによりすべての頂点を1、2、または4のいずれかの個数のボーンでスキニングするよう設定ができます。 4ボーンウェイトは外観も良い一方で、処理コストが高くなります。2ボーンウェイトは良い妥協点であり、一般的にゲームで使用することができます。

``Quality``が``Automatic``にセットされた場合[[class-QualitySettings|Quality Settings]] の``Blend Weights`` が使用されます。これによりエンドユーザが最適なパフォーマンスの品質設定を選択することができます。


!!! 画面外の更新とBounds（境界）

デフォルトでは、表示されていないスキンメッシュは更新されません。メッシュが画面内に戻ってくるまでのスキニングは更新されません。これはパフォーマンスの最適化の観点で重要なポイントで、たくさんのキャラクターが走り回っても非表示のときは処理負荷を抑えることができます。

しかし、VisibilityはメッシュのBounds（境界）により決定され、インポート時に事前計算されます。Unityはすべてのアタッチされたアニメーションを境界の大きさ事前計算において考慮しますが、場いいによってはUnityが強化をユーザのニーズに合うように計算できないことがあります。例えば：（いずれも問題となってくるのはボーンや頂点を事前計算された領域外に押し出されるときです。）
* ランタイム時にアニメーションを追加した場合
* Additive（追加）アニメーションを使用した場合
* ボーンの位置をプロシージャで影響を及ぼした場合
* 頂点シェーダを使用して、事前計算された境界の外に頂点を押し出した場合
* Ragdollを使用した場合。

これらの例では、2つの解決方法があります：
# Bounds（境界）を修正してメッシュの潜在的な境界の大きさにマッチできるように修正します。
# ``Update When Offscreen``をSkinおよびレンダリングされたSkinned Meshに対して常にオンにします。

殆どの場合、最初の方法がパフォーマンスに与える影響も少ないため、選択することになりますが、二つめの方法はパフォーマンスを重視する必要がなく、境界の大きさを予測することが難しい場合のみ使用して下さい。（例えばRagdollの場合）

SkinnedMeshをRagdollで上手に機能させるために、Unityは、ルートボーンに対してSkinnedMeshRendererを再マッピングします。しかしUnityモデルファイルに対してひとつのみSkinnedMeshRendererがある場合にこれを行います。
したがってすべてのSkinnedMeshRendererをルートボーンや子オブジェクトにアタッチできない場合やRagdollを使用する場合、この最適化をオフにする必要があります。

!! ヒント

* Skinned Meshが現在インポートできるのは：
** Maya
** Cinema4D
** 3D Studio Max
** Blender
** Cheetah 3D
** XSI
** FBXフォーマットをサポートしている他のあらゆるツール
